<html>
    <head>
        <title>WebWork 2 : 主题</title>
	    <link rel="stylesheet" href="styles/site.css" type="text/css" />
        <META http-equiv="Content-Type" content="text/html; charset=GBK">	    
    </head>

    <body>
	    <table class="pagecontent" border="0" cellpadding="0" cellspacing="0" width="100%" bgcolor="#ffffff">
		    <tr>
			    <td valign="top" class="pagebody">
				    <div class="pageheader">
					    <span class="pagetitle">
                            WebWork 2 : 主题
                                                    </span>
				    </div>
				    <div class="pagesubheading">
					    This page last changed on Dec 14, 2004 by <font color="#0050B2">casey</font>.
				    </div>

				    <p class="paragraph">主题是一组用于定制使用UI标签开发的页面的<a href="Templates.html" title="Templates">模版</a>.  它提供了一个强大的机制允许web开发人员使用混合风格(颜色, 字体等)为用户界面增添亮色.  例如, 你可能希望表单中一半文本框使用蓝色背景而另一半使用白色背景.   注意:</p><ul class="star">
<li> Webwork附带两个已定义的主题; &quot;simple&quot;和&quot;xhtml&quot;(缺省的).  WebWork缺省在应用的<tt class="monospaced">/template</tt>目录下查找主题.  缺省主题是<tt class="monospaced">xhtml</tt>.  这意味着如果你没有在UI标签中指定theme属性的话, 将使用缺省主题.  <ins class="inserted">注意:</ins> 你可以在<a href="webwork.properties.html" title="webwork.properties">webwork.properties</a>文件中修改<tt class="monospaced">webwork.ui.theme=</tt>和<tt class="monospaced">webwork.ui.templateDir=</tt>来改变缺省值.</li>
</ul>
<ul class="star">
<li> 也可以创建定制主题以适合自己的需要.  我们推荐参考已定义的模版作为起点.</li>
</ul>
<ul class="star">
<li> 每次使用UI标签时, 标签都引用一个模版来绘制HTML.  因此模版决定了字段外观和它在页面上的位置.  目前, 仅支持velocity模版.  无论如何, 希望在未来版本中支持创建JSP模版.</li>
</ul><br/>
<ins class="inserted">注意:</ins> 在继续之前, 推荐你复查WebWork模版系统的工作原理.  (参见<a href="Templates.html" title="Templates">模版</a>)<p class="paragraph"><h3 class="heading3"><a name="Themes-xhtml">  xhtml</a></h3></p><tt class="monospaced">xhtml</tt>是WebWork附带的缺省主题.  它扩展了simple主题并提供内建的错误报告, 表格定位和添加文本标签的功能.  然我们看看最常用的UI标签, <tt class="monospaced">textfield</tt>, 并展示使用XHTML主题创建视图的正确方法.<p class="paragraph">你可能已经知道, textfield标签使用的缺省模版是/template/xhtml目录下的text.vm.</p><div class="code"><div class="codeContent">
<pre>#&#42;&#10;   &#45;&#45; text.vm&#10;&#42;#&#10;## notice the re&#45;use of the simple theme template text.vm&#10;#parse(<span class="java&#45;quote">&quot;/template/xhtml/controlheader.vm&quot;</span>)&#10;#parse(<span class="java&#45;quote">&quot;/template/simple/text.vm&quot;</span>)&#10;#parse(<span class="java&#45;quote">&quot;/template/xhtml/controlfooter.vm&quot;</span>)</pre>
</div></div><br/>
该模版加载时, 将首先解析并绘制/template/xhtml/controlheader.vm.  在controlheader.vm中可以看到错误报告, 表格定位和添加文本标签的功能.  如果ActionSupport返回了错误, 将使用这个模版绘制成HTML.  还能看到如何获取parameter.label的值并使用表格元素tr和td进行定位.<br/>

<div class="code"><div class="codeContent">
<pre>#&#42;&#10;   &#45;&#45; controlheader.vm&#10;&#42;#&#10;## Only show message if errors are available.&#10;## This will be done if ActionSupport is used.&#10;&#10;#if( $fieldErrors.get($parameters.name) )&#10;  #set ($hasFieldErrors = $fieldErrors.get($parameters.name))&#10;  #foreach ($error in $fieldErrors.get($parameters.name))&#10;    <span class="xml&#45;tag">&lt;tr&gt;</span>&#10;        #if ($parameters.labelposition == &#039;top&#039;)&#10;            <span class="xml&#45;tag">&lt;td align=<span class="xml&#45;quote">&quot;left&quot;</span> valign=<span class="xml&#45;quote">&quot;top&quot;</span> colspan=<span class="xml&#45;quote">&quot;2&quot;</span>&gt;</span>&#10;        #else&#10;            <span class="xml&#45;tag">&lt;td align=<span class="xml&#45;quote">&quot;center&quot;</span> valign=<span class="xml&#45;quote">&quot;top&quot;</span> colspan=<span class="xml&#45;quote">&quot;2&quot;</span>&gt;</span>&#10;        #end&#10;            <span class="xml&#45;tag">&lt;span class=<span class="xml&#45;quote">&quot;errorMessage&quot;</span>&gt;</span>$&#33;webwork.htmlEncode($error)<span class="xml&#45;tag">&lt;/span&gt;</span>&#10;            <span class="xml&#45;tag">&lt;/td&gt;</span>&#10;    <span class="xml&#45;tag">&lt;/tr&gt;</span>&#10;  #end&#10;#end&#10;&#10;## Provides alignment behavior with table tags&#10;## if the label position is top,&#10;## then give the label it&#039;s own row in the table&#10;## otherwise, display the label to the left on same row&#10;&#10;<span class="xml&#45;tag">&lt;tr&gt;</span>&#10;    #if ($parameters.labelposition == &#039;top&#039;)&#10;        <span class="xml&#45;tag">&lt;td align=<span class="xml&#45;quote">&quot;left&quot;</span> valign=<span class="xml&#45;quote">&quot;top&quot;</span> colspan=<span class="xml&#45;quote">&quot;2&quot;</span>&gt;</span>&#10;    #else&#10;        <span class="xml&#45;tag">&lt;td align=<span class="xml&#45;quote">&quot;right&quot;</span> valign=<span class="xml&#45;quote">&quot;top&quot;</span>&gt;</span>&#10;    #end&#10;&#10;        #if ($hasFieldErrors)&#10;            <span class="xml&#45;tag">&lt;span class=<span class="xml&#45;quote">&quot;errorLabel&quot;</span>&gt;</span>&#10;        #else&#10;            <span class="xml&#45;tag">&lt;span class=<span class="xml&#45;quote">&quot;label&quot;</span>&gt;</span>&#10;        #end&#10;&#10;## If you want to mark required form fields with an asterisk, &#10;## you can set the required attribute&#10;## Ex. <span class="xml&#45;tag">&lt;ui:textfield label=<span class="xml&#45;quote">&quot;&#039;mylabel&#039;&quot;</span> name=<span class="xml&#45;quote">&quot;&#039;myname&#039;&quot;</span> required=<span class="xml&#45;quote">&quot;&#039;true&#039;&quot;</span> /&gt;</span> &#10;        #if ($parameters.label)&#10;            #if ($parameters.required) <span class="xml&#45;tag">&lt;span class=<span class="xml&#45;quote">&quot;required&quot;</span>&gt;</span>&#42;<span class="xml&#45;tag">&lt;/span&gt;</span> #end &#10;               $&#33;webwork.htmlEncode($parameters.label):&#10;        #end&#10;            <span class="xml&#45;tag">&lt;/span&gt;</span>&#10;        <span class="xml&#45;tag">&lt;/td&gt;</span>&#10;&#10;## add the extra row&#10;#if ($parameters.labelposition == &#039;top&#039;)&#10;<span class="xml&#45;tag">&lt;/tr&gt;</span>&#10;<span class="xml&#45;tag">&lt;tr&gt;</span>&#10;#end&#10;    <span class="xml&#45;tag">&lt;td&gt;</span></pre>
</div></div><br/>
下一个被/template/xhtml/text.vm解析的模版是/template/simple/text.vm.  这里可以看到实际的HTML的text元素如何绘制以及参数如何传递的.
<div class="code"><div class="codeContent">
<pre>#&#42;&#10;  &#45;&#45; text.vm&#10;  &#45;&#45;&#10;  &#45;&#45; Required Parameters:&#10;  &#45;&#45;   &#42; label      &#45; The description that will be used to identfy the control.&#10;  &#45;&#45;   &#42; name       &#45; The name of the attribute to put and pull the result from.&#10;  &#45;&#45;                  Equates to the NAME parameter of the HTML INPUT tag.&#10;  &#45;&#45;&#10;  &#45;&#45; Optional Parameters:&#10;  &#45;&#45;   &#42; labelposition   &#45; determines were the label will be place in relation&#10;  &#45;&#45;                       to the control.  Default is to the left of the control.&#10;  &#45;&#45;   &#42; size       &#45; SIZE parameter of the HTML INPUT tag.&#10;  &#45;&#45;   &#42; maxlength  &#45; MAXLENGTH parameter of the HTML INPUT tag.&#10;  &#45;&#45;   &#42; disabled   &#45; DISABLED parameter of the HTML INPUT tag.&#10;  &#45;&#45;   &#42; readonly   &#45; READONLY parameter of the HTML INPUT tag.&#10;  &#45;&#45;   &#42; onkeyup    &#45; onkeyup parameter of the HTML INPUT tag.&#10;  &#45;&#45;   &#42; tabindex  &#45; tabindex parameter of the HTML INPUT tag.&#10;  &#45;&#45;   &#42; onchange  &#45; onkeyup parameter of the HTML INPUT tag.&#10;  &#45;&#45;&#10;    &#42;#&#10;<span class="xml&#45;tag">&lt;input type=<span class="xml&#45;quote">&quot;text&quot;</span>&#10;                                   name=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.name)&quot;</span>&#10;#if ($parameters.size)             size=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.size)&quot;</span>            #end&#10;#if ($parameters.maxlength)        maxlength=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.maxlength)&quot;</span>  #end&#10;#if ($parameters.nameValue)        value=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.nameValue)&quot;</span>      #end&#10;#if ($parameters.disabled == true) disabled=<span class="xml&#45;quote">&quot;disabled&quot;</span>                                      #end&#10;#if ($parameters.readonly)         readonly=<span class="xml&#45;quote">&quot;readonly&quot;</span>                                      #end&#10;#if ($parameters.onkeyup)          onkeyup=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.onkeyup)&quot;</span>      #end&#10;#if ($parameters.tabindex)         tabindex=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.tabindex)&quot;</span>    #end&#10;#if ($parameters.onchange)         onchange=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.onchange)&quot;</span>    #end&#10;#if ($parameters.id)               id=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.id)&quot;</span>                #end&#10;#if ($parameters.cssClass)         class=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.cssClass)&quot;</span>       #end&#10;#if ($parameters.cssStyle)         style=<span class="xml&#45;quote">&quot;$&#33;webwork.htmlEncode($parameters.cssStyle)&quot;</span>       #end&#10;/&gt;</span></pre>
</div></div>&#160;<br/>
最后, 解析controlfooter.vm, 关闭controlheader.vm中输出的tr和td.
<div class="code"><div class="codeContent">
<pre>#&#42;&#10;   &#45;&#45; controlheader.vm&#10;&#42;#&#10;&#10;  <span class="xml&#45;tag">&lt;/td&gt;</span>&#10;<span class="xml&#45;tag">&lt;/tr&gt;</span></pre>
</div></div><p class="paragraph">在我们的视图中, 由于tr和td元素已经创建好了, 我们只需要简单的用table元素将它们包装起来.  出于学习的缘故, 我们仅使用普通的table对象, 但也可以看看table.vm的内容.
<div class="code"><div class="codeContent">
<pre><span class="xml&#45;tag">&lt;&#37;&#64; taglib uri=<span class="xml&#45;quote">&quot;webwork&quot;</span> prefix=<span class="xml&#45;quote">&quot;ui&quot;</span> &#37;&gt;</span>&#10;<span class="xml&#45;tag">&lt;link rel =<span class="xml&#45;quote">&quot;stylesheet&quot;</span> type=<span class="xml&#45;quote">&quot;text/css&quot;</span> href=<span class="xml&#45;quote">&quot;template/xhtml/styles.css&quot;</span> title=<span class="xml&#45;quote">&quot;Style&quot;</span>&gt;</span>&#10;<span class="xml&#45;tag">&lt;html&gt;</span>&#10;<span class="xml&#45;tag">&lt;head&gt;</span><span class="xml&#45;tag">&lt;title&gt;</span>JSP PAGE<span class="xml&#45;tag">&lt;/title&gt;</span><span class="xml&#45;tag">&lt;/head&gt;</span>&#10;<span class="xml&#45;tag">&lt;body&gt;</span>&#10;<span class="xml&#45;tag">&lt;form&gt;</span>&#10;  <span class="xml&#45;tag">&lt;table&gt;</span>&#10;	<span class="xml&#45;tag"><span class="xml&#45;comment">&lt;&#33;&#45;&#45; we can set the required attribute to true if we want to &#10;	     display and asterisk next to required form fields&#10;	 &#45;&#45;&gt;</span></span>&#10;&#10;	<span class="xml&#45;tag">&lt;ui:textfield label=<span class="xml&#45;quote">&quot;&#039;Username&#039;&quot;</span> required=<span class="xml&#45;quote">&quot;&#039;true&#039;&quot;</span> name=<span class="xml&#45;quote">&quot;&#039;user&#039;&quot;</span> /&gt;</span> &#10;	<span class="xml&#45;tag">&lt;ui:textfield label=<span class="xml&#45;quote">&quot;&#039;Email&#039;&quot;</span> name=<span class="xml&#45;quote">&quot;&#039;email&#039;&quot;</span>/&gt;</span> &#10;  <span class="xml&#45;tag">&lt;/table&gt;</span>&#10;<span class="xml&#45;tag">&lt;/form&gt;</span>&#10;<span class="xml&#45;tag">&lt;/body&gt;</span>&#10;<span class="xml&#45;tag">&lt;/html&gt;</span></pre>
</div></div></p><div class="code"><div class="codeContent">
<pre><span class="xml&#45;tag">&lt;link rel =<span class="xml&#45;quote">&quot;stylesheet&quot;</span> type=<span class="xml&#45;quote">&quot;text/css&quot;</span> href=<span class="xml&#45;quote">&quot;template/xhtml/styles.css&quot;</span> title=<span class="xml&#45;quote">&quot;Style&quot;</span>&gt;</span>&#10;<span class="xml&#45;tag">&lt;html&gt;</span>&#10;<span class="xml&#45;tag">&lt;head&gt;</span><span class="xml&#45;tag">&lt;title&gt;</span>VM PAGE<span class="xml&#45;tag">&lt;/title&gt;</span><span class="xml&#45;tag">&lt;/head&gt;</span>&#10;<span class="xml&#45;tag">&lt;body&gt;</span>&#10;<span class="xml&#45;tag">&lt;form&gt;</span>&#10;  <span class="xml&#45;tag">&lt;table&gt;</span>&#10;    #tag( TextField <span class="xml&#45;quote">&quot;label=&#039;Username&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;name=&#039;user&#039;&quot;</span> )<span class="xml&#45;tag">&lt;br&gt;</span>&#10;    #tag( TextField <span class="xml&#45;quote">&quot;label=&#039;Email&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;name=&#039;email&#039;&quot;</span> )<span class="xml&#45;tag">&lt;br&gt;</span>&#10;  <span class="xml&#45;tag">&lt;/table&gt;</span>&#10;<span class="xml&#45;tag">&lt;/form&gt;</span>&#10;<span class="xml&#45;tag">&lt;/body&gt;</span>&#10;<span class="xml&#45;tag">&lt;/html&gt;</span></pre>
</div></div><p class="paragraph"><h3 class="heading3"><a name="Themes-simple">  simple</a></h3></p><tt class="monospaced">simple</tt>仅提供HTML标签而不包含附加功能(与struts类似).  该主题只考虑底层结构, 可以像xhml那样复用以增加额外的功能或行为.  你可以很容易的扩展该主题来创建你自己的主题, 以便建立更复杂的页面来满足要求.<br/>
使用已定义的主题<tt class="monospaced">simple</tt>
<div class="code"><div class="codeContent">
<pre><span class="xml&#45;tag">&lt;&#37;&#64; taglib uri=<span class="xml&#45;quote">&quot;webwork&quot;</span> prefix=<span class="xml&#45;quote">&quot;ui&quot;</span> &#37;&gt;</span>&#10;<span class="xml&#45;tag">&lt;link rel =<span class="xml&#45;quote">&quot;stylesheet&quot;</span> type=<span class="xml&#45;quote">&quot;text/css&quot;</span> href=<span class="xml&#45;quote">&quot;template/xhtml/styles.css&quot;</span> title=<span class="xml&#45;quote">&quot;Style&quot;</span>&gt;</span>&#10;<span class="xml&#45;tag">&lt;html&gt;</span>&#10;<span class="xml&#45;tag">&lt;head&gt;</span><span class="xml&#45;tag">&lt;title&gt;</span>JSP PAGE<span class="xml&#45;tag">&lt;/title&gt;</span><span class="xml&#45;tag">&lt;/head&gt;</span>&#10;<span class="xml&#45;tag">&lt;body&gt;</span>&#10;  <span class="xml&#45;tag">&lt;form&gt;</span>&#10;	<span class="xml&#45;tag">&lt;ui:label name=<span class="xml&#45;quote">&quot;&#039;userlabel&#039;&quot;</span> label=<span class="xml&#45;quote">&quot;&#039;user&quot;</span> theme=<span class="xml&#45;quote">&quot;&#039;simple&#039;&quot;</span>/&gt;</span>&#10;                <span class="xml&#45;tag">&lt;ui:textfield name=<span class="xml&#45;quote">&quot;&#039;user&#039;&quot;</span> theme=<span class="xml&#45;quote">&quot;&#039;simple&#039;&quot;</span>/&gt;</span>&#10;&#10;	<span class="xml&#45;tag">&lt;ui:label name=<span class="xml&#45;quote">&quot;&#039;emaillabel&#039;&quot;</span> label=<span class="xml&#45;quote">&quot;&#039;user&quot;</span> theme=<span class="xml&#45;quote">&quot;&#039;simple&#039;&quot;</span>/&gt;</span>&#10;                <span class="xml&#45;tag">&lt;ui:textfield name=<span class="xml&#45;quote">&quot;&#039;email&#039;&quot;</span> theme=<span class="xml&#45;quote">&quot;&#039;simple&#039;&quot;</span>/&gt;</span>&#10;  <span class="xml&#45;tag">&lt;/form&gt;</span>&#10;<span class="xml&#45;tag">&lt;/body&gt;</span>&#10;<span class="xml&#45;tag">&lt;/html&gt;</span></pre>
</div></div><br/>

<div class="code"><div class="codeContent">
<pre><span class="xml&#45;tag">&lt;link rel =<span class="xml&#45;quote">&quot;stylesheet&quot;</span> type=<span class="xml&#45;quote">&quot;text/css&quot;</span> href=<span class="xml&#45;quote">&quot;template/xhtml/styles.css&quot;</span> title=<span class="xml&#45;quote">&quot;Style&quot;</span>&gt;</span>&#10;<span class="xml&#45;tag">&lt;html&gt;</span>&#10;<span class="xml&#45;tag">&lt;head&gt;</span><span class="xml&#45;tag">&lt;title&gt;</span>VM PAGE<span class="xml&#45;tag">&lt;/title&gt;</span><span class="xml&#45;tag">&lt;/head&gt;</span>&#10;<span class="xml&#45;tag">&lt;body&gt;</span>&#10;  <span class="xml&#45;tag">&lt;form&gt;</span>&#10;#tag( Label  <span class="xml&#45;quote">&quot;name=&#039;userlabel&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;label=&#039;user&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;theme=&#039;simple&#039;&quot;</span> )&#10;#tag( TextField  <span class="xml&#45;quote">&quot;name=&#039;user&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;theme=&#039;simple&#039;&quot;</span> )<span class="xml&#45;tag">&lt;br&gt;</span>&#10;&#10;#tag( Label  <span class="xml&#45;quote">&quot;name=&#039;emaillabel&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;label=&#039;email&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;theme=&#039;simple&#039;&quot;</span> )&#10;#tag( TextField  <span class="xml&#45;quote">&quot;name=&#039;email&#039;&quot;</span>&#160;<span class="xml&#45;quote">&quot;theme=&#039;simple&#039;&quot;</span> )<span class="xml&#45;tag">&lt;br&gt;</span>&#10;  <span class="xml&#45;tag">&lt;/form&gt;</span>&#10;<span class="xml&#45;tag">&lt;/body&gt;</span>&#10;<span class="xml&#45;tag">&lt;/html&gt;</span></pre>
</div></div><p class="paragraph"><h3 class="heading3"><a name="Themes-Creatingyourowntheme%3Caname%3D%22Themescustom%22%3E%3C%2Fa%3E">  创建你自己的主题 <a name="Themes-custom"></a></a></h3></p>创建主题非常简单, 并能在创建复杂UI页面时帮助你节省时间, 最小化代码.  在继续之前推荐你理解WebWork的模版系统(参见<a href="Templates.html" title="Templates">模版</a>).  使用一个模版需要下列步骤.
<ol>
<li> 定义主题的名字并在/template目录下创建一个子目录.  子目录的名字应当和你在UI标签theme属性中指定的值相同.
<div class="code"><div class="codeContent">
<pre>/template/myTheme</pre>
</div></div>
<div class="code"><div class="codeContent">
<pre><span class="xml&#45;tag">&lt;ui:textfield label=<span class="xml&#45;quote">&quot;&#039;foo&#039;&quot;</span> name=<span class="xml&#45;quote">&quot;&#039;bar&#039;&quot;</span> theme=<span class="xml&#45;quote">&quot;&#039;myTheme&#039;&quot;</span> /&gt;</span></pre>
</div></div>
</li>
<li> 为每一个想使用UI标签创建一个velocity模版.  例如, 如果表单中只有textfield没有其他控件, 你的子目录下只需要一个text.vm模版.  注意: 如果你创建一个text.vm并用parse标签引用其他模版, 你必须确保这些模版已经定义好了(例如, controlheader.vm).</li>
<li> 如果想把新的主题作为缺省主题, 从而不需要在UI标签中指定theme属性, 这需要修改webwork.properties中的webwork.ui.theme.  否则, 你只能在所有UI标签中指定theme属性.</li>
</ol><p class="paragraph">把xhtml的内容复制到新的目录中是一个好的开始.  这样, 你可以修改模版, 并仍然可以把原始内容作为参考点.</p>

				    
                    			    </td>
		    </tr>
	    </table>
	    <table border="0" cellpadding="0" cellspacing="0" width="100%">
			<tr>
				<td height="12" background="border/border_bottom.gif"><img src="border/spacer.gif" width="1" height="1" border="0"/></td>
			</tr>
		    <tr>
			    <td align="center"><font color="grey">Document generated by Confluence on Dec 14, 2004 16:36</font></td>
		    </tr>
	    </table>
    </body>
</html>